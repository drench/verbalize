#!/usr/bin/env ruby

require 'bundler/setup'
require 'verbalize'

# You can add fixtures and/or initialization code here to make experimenting
# with your gem easier. You can also use a different console, if you like.

class Add
  include Verbalize::Action

  input :a, :b

  def call
    a + b
  end
end

class Subtract
  include Verbalize::Action

  input :a, :b

  def call
    a - b
  end
end

class Divide
  include Verbalize::Action

  input :a, :b

  def call
    fail!('Can\'t divide by 0 you crazy person!') if b == 0

    a / b
  end
end

$failure_result = Add.call(a: 1, b: 2)
  .and_then{ |sum| Subtract.call(a: sum, b: 3) }
  .and_then{ |difference| Divide.call(a: 42, b: difference) }
  .and_then{ |dude| raise 'This won’t be raised ‘cuase you won’t get here' }

$success_result = Add.call(a: 2, b: 2)
  .and_then{ |sum| Subtract.call(a: sum, b: 3) }
  .and_then{ |difference| Divide.call(a: 42, b: difference) }

$success_value = Add.call(a: 2, b: 2)
  .and_then{ |sum| Subtract.call(a: sum, b: 3) }
  .and_then{ |difference| Divide.call(a: 42, b: difference) }
  .unwrap!

require 'pry'
Pry.start
